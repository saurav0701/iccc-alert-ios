name: Build iOS App with FREE Code Signing (No $99!)

on:
  workflow_dispatch:
  push:
    branches: [ main, develop ]

jobs:
  build-signed-ipa:
    name: Build Signed IPA (7-Day Certificate)
    runs-on: macos-latest
    
    steps:
    - name: Checkout Code
      uses: actions/checkout@v4
    
    - name: Display Info
      run: |
        echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
        echo "Building iOS App with FREE Apple ID Code Signing"
        echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
        echo ""
        echo "ðŸ“± Target Device: iPhone 7 (iOS 15.8.5)"
        echo "â° Certificate Validity: 7 days"
        echo "ðŸ’° Cost: FREE (No Apple Developer Account needed!)"
        echo "ðŸ”„ After 7 days: Just rebuild and reinstall"
        echo ""
    
    - name: Setup Xcode
      run: |
        sudo xcode-select --switch /Applications/Xcode.app/Contents/Developer
        xcodebuild -version
    
    - name: Install Dependencies
      run: |
        sudo gem install xcodeproj
        brew install ruby
    
    - name: Generate Xcode Project
      run: ruby generate_project.rb
    
    - name: Configure Bundle Identifier
      run: |
        # Use a unique bundle ID with your domain or a generic one
        BUNDLE_ID="com.iccc.alert.$(date +%Y%m%d)"
        echo "Using Bundle ID: $BUNDLE_ID"
        echo "BUNDLE_ID=$BUNDLE_ID" >> $GITHUB_ENV
        
        # Update Info.plist with bundle ID
        /usr/libexec/PlistBuddy -c "Set :CFBundleIdentifier $BUNDLE_ID" ICCCAlert/Info.plist || true
    
    - name: Setup Fastlane
      run: |
        sudo gem install fastlane -NV
        
        # Create Fastlane directory
        mkdir -p fastlane
        
        # Create Appfile
        cat > fastlane/Appfile << EOF
        apple_id ENV["APPLE_ID"]
        team_id ENV["TEAM_ID"]
        
        for_platform :ios do
          app_identifier ENV["BUNDLE_ID"]
        end
        EOF
        
        # Create Fastfile - WITHOUT device registration to avoid auth issues
        cat > fastlane/Fastfile << 'EOF'
        default_platform(:ios)

        platform :ios do
          desc "Build and sign the app with free provisioning"
          lane :build_free do
            
            puts "ðŸ” Authenticating with Apple..."
            
            # Get certificates (creates if needed)
            cert(
              username: ENV["APPLE_ID"],
              team_id: ENV["TEAM_ID"],
              development: true
            )

            puts "ðŸ“„ Getting provisioning profile..."
            
            # Get provisioning profile (creates if needed)
            sigh(
              username: ENV["APPLE_ID"],
              app_identifier: ENV["BUNDLE_ID"],
              team_id: ENV["TEAM_ID"],
              development: true,
              force: true,
              skip_certificate_verification: false
            )

            puts "ðŸ—ï¸ Building IPA..."
            
            # Build the app
            gym(
              project: "ICCCAlert.xcodeproj",
              scheme: "ICCCAlert",
              export_method: "development",
              configuration: "Release",
              output_directory: "./build",
              output_name: "ICCCAlert-Signed.ipa",
              export_options: {
                method: "development",
                signingStyle: "automatic",
                teamID: ENV["TEAM_ID"],
                iCloudContainerEnvironment: "Development"
              }
            )
            
            puts "âœ… Build complete!"
          end
        end
        EOF
        
        echo "âœ… Fastlane configured"
    
    - name: Setup Credentials
      env:
        APPLE_ID: ${{ secrets.APPLE_ID }}
        APP_SPECIFIC_PASSWORD: ${{ secrets.APP_SPECIFIC_PASSWORD }}
        IPHONE_UDID: ${{ secrets.IPHONE_UDID }}
        TEAM_ID: ${{ secrets.TEAM_ID }}
      run: |
        echo "ðŸ” Checking required secrets..."
        echo ""
        
        HAS_ERROR=0
        
        if [ -z "$APPLE_ID" ]; then
          echo "âŒ ERROR: APPLE_ID secret not set!"
          echo "   â†’ Go to GitHub repo Settings â†’ Secrets â†’ Actions"
          echo "   â†’ Add APPLE_ID = your@email.com"
          HAS_ERROR=1
        else
          echo "âœ… APPLE_ID is set: $APPLE_ID"
        fi
        
        if [ -z "$APP_SPECIFIC_PASSWORD" ]; then
          echo ""
          echo "âŒ ERROR: APP_SPECIFIC_PASSWORD secret not set!"
          echo ""
          echo "   ðŸ“ How to generate App-Specific Password:"
          echo "   1. Go to https://appleid.apple.com/"
          echo "   2. Sign in with your Apple ID"
          echo "   3. In Security section, find 'App-Specific Passwords'"
          echo "   4. Click 'Generate Password' or '+'"
          echo "   5. Name it 'GitHub Fastlane'"
          echo "   6. Copy the password (format: xxxx-xxxx-xxxx-xxxx)"
          echo "   7. Go to GitHub repo Settings â†’ Secrets â†’ Actions"
          echo "   8. Add APP_SPECIFIC_PASSWORD = (paste password here)"
          echo ""
          HAS_ERROR=1
        else
          echo "âœ… APP_SPECIFIC_PASSWORD is set"
        fi
        
        if [ -z "$TEAM_ID" ]; then
          echo ""
          echo "âŒ ERROR: TEAM_ID secret not set!"
          echo ""
          echo "   ðŸ“ How to find your Team ID:"
          echo "   Method 1 - Using this workflow:"
          echo "   1. First, set APPLE_ID and APP_SPECIFIC_PASSWORD"
          echo "   2. Run this workflow - it will FAIL but show your Team ID in error"
          echo "   3. Look for 'Multiple teams found' or similar error"
          echo "   4. Copy the Team ID from error message"
          echo ""
          echo "   Method 2 - Using Apple Developer portal:"
          echo "   1. Go to https://developer.apple.com/account"
          echo "   2. Sign in"
          echo "   3. Click on your name in top right"
          echo "   4. Your Team ID is shown there"
          echo ""
          echo "   Then add it:"
          echo "   â†’ GitHub repo Settings â†’ Secrets â†’ Actions"
          echo "   â†’ Add TEAM_ID = YOUR_TEAM_ID"
          echo ""
          HAS_ERROR=1
        else
          echo "âœ… TEAM_ID is set: $TEAM_ID"
        fi
        
        if [ -z "$IPHONE_UDID" ]; then
          echo ""
          echo "âš ï¸ WARNING: IPHONE_UDID not set (optional but recommended)"
          echo ""
          echo "   ðŸ“ How to get iPhone UDID:"
          echo "   Method 1 - Using iPhone directly:"
          echo "   1. On iPhone, open Settings"
          echo "   2. Go to General â†’ About"
          echo "   3. Scroll down and tap on 'Serial Number' multiple times"
          echo "   4. It will switch to show UDID"
          echo "   5. Long press to copy"
          echo ""
          echo "   Method 2 - Using iTunes/Finder (if you have access to Mac):"
          echo "   1. Connect iPhone to computer"
          echo "   2. Open iTunes or Finder"
          echo "   3. Select iPhone"
          echo "   4. Click on Serial Number - it will show UDID"
          echo ""
          echo "   Then add it:"
          echo "   â†’ GitHub repo Settings â†’ Secrets â†’ Actions"
          echo "   â†’ Add IPHONE_UDID = your-iphone-udid"
          echo ""
          echo "   Note: Without UDID, you can still build but need to add device manually later"
          echo ""
        else
          echo "âœ… IPHONE_UDID is set: ${IPHONE_UDID:0:10}..."
        fi
        
        echo ""
        echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
        
        if [ $HAS_ERROR -eq 1 ]; then
          echo "âŒ Missing required secrets - please add them and re-run"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          exit 1
        fi
        
        echo "âœ… All required secrets are configured!"
        echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
        echo ""
        
        # Setup environment
        echo "APPLE_ID=$APPLE_ID" >> $GITHUB_ENV
        echo "FASTLANE_PASSWORD=$APP_SPECIFIC_PASSWORD" >> $GITHUB_ENV
        echo "FASTLANE_APPLE_APPLICATION_SPECIFIC_PASSWORD=$APP_SPECIFIC_PASSWORD" >> $GITHUB_ENV
        echo "FASTLANE_DONT_STORE_PASSWORD=1" >> $GITHUB_ENV
        echo "FASTLANE_SESSION=" >> $GITHUB_ENV
        echo "TEAM_ID=$TEAM_ID" >> $GITHUB_ENV
        
        if [ -n "$IPHONE_UDID" ]; then
          echo "IPHONE_UDID=$IPHONE_UDID" >> $GITHUB_ENV
          echo "IPHONE_NAME=iPhone7-Device" >> $GITHUB_ENV
        fi
    
    - name: Create Keychain
      run: |
        # Create temporary keychain for GitHub Actions
        security create-keychain -p temp_password temp.keychain
        security default-keychain -s temp.keychain
        security unlock-keychain -p temp_password temp.keychain
        security set-keychain-settings -t 3600 -l ~/Library/Keychains/temp.keychain
        
        echo "âœ… Keychain created and unlocked"
    
    - name: Build with Fastlane
      run: |
        echo "ðŸ—ï¸ Starting build with FREE code signing..."
        echo "This will:"
        echo "  1. Authenticate with Apple using your credentials"
        echo "  2. Create/download development certificate"
        echo "  3. Create/download provisioning profile"
        echo "  4. Build and sign the IPA"
        echo ""
        
        cd fastlane
        fastlane build_free || {
          echo ""
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "âš ï¸ BUILD FAILED"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo ""
          echo "Common issues and solutions:"
          echo ""
          echo "1. âŒ 'Invalid username and password combination'"
          echo "   â†’ Your APP_SPECIFIC_PASSWORD is wrong or expired"
          echo "   â†’ Generate a NEW one at https://appleid.apple.com/"
          echo "   â†’ Update APP_SPECIFIC_PASSWORD secret in GitHub"
          echo ""
          echo "2. âŒ 'Multiple teams found' or similar Team ID error"
          echo "   â†’ The error message will show your Team ID"
          echo "   â†’ Copy it and add as TEAM_ID secret in GitHub"
          echo "   â†’ Format usually looks like: ABC1234XYZ"
          echo ""
          echo "3. âŒ '2FA not enabled' or authentication error"
          echo "   â†’ Go to https://appleid.apple.com/"
          echo "   â†’ Sign in â†’ Security section"
          echo "   â†’ Enable Two-Factor Authentication"
          echo "   â†’ Then generate app-specific password"
          echo ""
          echo "4. âŒ 'No such file or directory' - project errors"
          echo "   â†’ Make sure generate_project.rb exists and runs"
          echo "   â†’ Check previous steps for errors"
          echo ""
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "ðŸ’¡ TIP: Read the error message above carefully!"
          echo "     It often contains the exact solution (like your Team ID)"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo ""
          exit 1
        }
    
    - name: Verify IPA
      run: |
        echo "ðŸ” Verifying the signed IPA..."
        echo ""
        
        if [ -f "./build/ICCCAlert-Signed.ipa" ]; then
          echo "âœ… Signed IPA created successfully!"
          ls -lh ./build/ICCCAlert-Signed.ipa
          
          # Show IPA contents
          echo ""
          echo "ðŸ“‹ IPA Contents:"
          unzip -l ./build/ICCCAlert-Signed.ipa | grep -E "(Payload|embedded.mobileprovision|ICCCAlert)" | head -20
          
          echo ""
          
          # Check for provisioning profile
          if unzip -l ./build/ICCCAlert-Signed.ipa | grep -q "embedded.mobileprovision"; then
            echo "âœ… Provisioning profile is embedded in IPA"
            
            # Extract and show some info about the profile
            unzip -p ./build/ICCCAlert-Signed.ipa "Payload/ICCCAlert.app/embedded.mobileprovision" > /tmp/profile.mobileprovision 2>/dev/null || true
            if [ -f "/tmp/profile.mobileprovision" ]; then
              echo ""
              echo "ðŸ“„ Provisioning Profile Info:"
              security cms -D -i /tmp/profile.mobileprovision > /tmp/profile.plist 2>/dev/null || true
              if [ -f "/tmp/profile.plist" ]; then
                echo "   Team ID: $(/usr/libexec/PlistBuddy -c "Print :TeamIdentifier:0" /tmp/profile.plist 2>/dev/null || echo 'N/A')"
                echo "   Creation Date: $(/usr/libexec/PlistBuddy -c "Print :CreationDate" /tmp/profile.plist 2>/dev/null || echo 'N/A')"
                echo "   Expiration Date: $(/usr/libexec/PlistBuddy -c "Print :ExpirationDate" /tmp/profile.plist 2>/dev/null || echo 'N/A')"
              fi
            fi
          else
            echo "âš ï¸ Warning: No provisioning profile found in IPA"
          fi
          
          echo ""
          echo "âœ… IPA is ready for download and installation!"
        else
          echo "âŒ ERROR: IPA file was not created"
          echo ""
          echo "Checking build directory:"
          ls -la ./build/ 2>/dev/null || echo "Build directory doesn't exist"
          echo ""
          echo "Something went wrong during the build process."
          echo "Check the 'Build with Fastlane' step above for errors."
          exit 1
        fi
    
    - name: Upload Signed IPA
      uses: actions/upload-artifact@v4
      with:
        name: ICCCAlert-Signed-IPA
        path: build/ICCCAlert-Signed.ipa
        retention-days: 30
    
    - name: Create Installation Guide
      run: |
        cat > ./build/INSTALLATION_INSTRUCTIONS.txt << 'EOF'
        â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
        â•‘       ICCCAlert - Installation Guide for iPhone 7            â•‘
        â•‘              (FREE 7-Day Signing - No Mac Needed!)           â•‘
        â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        ðŸŽ‰ CONGRATULATIONS! Your app is signed and ready!

        This IPA is signed with your FREE Apple ID for 7 DAYS.

        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        ðŸ“± INSTALLATION METHOD 1: Diawi (NO MAC NEEDED!) â­ RECOMMENDED

        Perfect if you don't have a Mac! Install directly via iPhone Safari.

        1. Download the IPA:
           â†’ Go to GitHub Actions page
           â†’ Click on your completed workflow run
           â†’ Scroll to "Artifacts" section at bottom
           â†’ Download "ICCCAlert-Signed-IPA"
           â†’ Extract the ZIP to get ICCCAlert-Signed.ipa

        2. Upload to Diawi:
           â†’ Go to https://www.diawi.com/ on any computer
           â†’ Drag and drop ICCCAlert-Signed.ipa onto the page
           â†’ Wait 30-60 seconds for upload to complete
           â†’ You'll get a link like: https://i.diawi.com/XXXXXX
           â†’ COPY THIS LINK!

        3. Install on iPhone 7:
           â†’ Open Safari browser on your iPhone 7 (must be Safari!)
           â†’ Type or paste the Diawi link: i.diawi.com/XXXXXX
           â†’ Tap "Install" button
           â†’ Confirm installation when prompted
           â†’ Wait for app to download and install
           â†’ Done! âœ…

        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        ðŸ“± INSTALLATION METHOD 2: AltStore (Advanced)

        If Diawi doesn't work, try AltStore:

        1. Install AltStore on your computer:
           â†’ Windows: https://altstore.io/
           â†’ Follow installation instructions

        2. Install AltStore on iPhone:
           â†’ Connect iPhone to computer
           â†’ Follow AltStore setup wizard
           â†’ Install AltStore app on iPhone

        3. Install your IPA:
           â†’ Open AltStore app on iPhone
           â†’ Tap "+" icon
           â†’ Select ICCCAlert-Signed.ipa from computer
           â†’ Wait for installation
           â†’ Done! âœ…

        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        ðŸ“± INSTALLATION METHOD 3: Sideloadly (Advanced)

        Another option without Mac:

        1. Download Sideloadly:
           â†’ Go to https://sideloadly.io/
           â†’ Download for Windows or Mac

        2. Install your IPA:
           â†’ Connect iPhone 7 to computer
           â†’ Open Sideloadly
           â†’ Drag ICCCAlert-Signed.ipa into Sideloadly
           â†’ Enter your Apple ID credentials
           â†’ Click Start
           â†’ Wait for installation
           â†’ Done! âœ…

        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        ðŸ”“ TRUST THE CERTIFICATE (CRITICAL - REQUIRED FOR ALL METHODS!)

        After installation, you MUST trust the developer certificate:

        âš ï¸ If you skip this step, the app will NOT open!

        1. On your iPhone 7, open Settings app
        2. Navigate to: General â†’ VPN & Device Management
           (On older iOS: General â†’ Profiles & Device Management)
        3. Under "Developer App" section, find your Apple ID email
        4. Tap on your Apple ID
        5. Tap the blue "Trust [Your Apple ID]" button
        6. Confirm by tapping "Trust" again in popup
        7. Done! The app is now trusted

        Now you can launch ICCCAlert from your home screen! ðŸŽ‰

        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        âœ… APP IS NOW WORKING!

        You can now fully test:
        âœ… WebSocket real-time connections
        âœ… All app features and UI
        âœ… Performance on real iPhone 7
        âœ… iOS 15.8.5 compatibility
        âœ… Network connectivity
        âœ… Push notifications (if configured)

        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        â° CERTIFICATE EXPIRATION (7 Days)

        Your free code signing certificate expires after 7 DAYS.
        This is a limitation of free Apple Developer accounts.

        What happens after 7 days:
        â†’ The app will stop launching
        â†’ You'll see "Unable to Verify App" error
        â†’ This is completely normal!

        How to renew (takes 3 minutes):
        1. Go to your GitHub repository
        2. Click "Actions" tab at top
        3. Click "Build iOS App with FREE Code Signing"
        4. Click "Run workflow" button (right side)
        5. Click green "Run workflow" button
        6. Wait 5-10 minutes for build
        7. Download new IPA from artifacts
        8. Reinstall using same method (Diawi, etc.)
        9. Trust certificate again in Settings
        10. Done! Another 7 days! ðŸ”„

        ðŸ’¡ PRO TIP: Set a phone reminder for 6 days from today
                   to rebuild before the certificate expires!

        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        âš ï¸ TROUBLESHOOTING COMMON ISSUES:

        âŒ "Unable to Install App" or "Cannot Connect to [domain]"
        Solution:
        â†’ Make sure you're using Safari browser (not Chrome!)
        â†’ Try clearing Safari cache: Settings â†’ Safari â†’ Clear History
        â†’ Restart your iPhone and try again
        â†’ Make sure iPhone has good internet connection

        âŒ "Untrusted Developer" or "Unable to Verify App"
        Solution:
        â†’ You MUST trust the certificate! (see steps above)
        â†’ Go to Settings â†’ General â†’ Device Management
        â†’ Find your Apple ID and tap Trust

        âŒ "This app cannot be installed because its integrity could not be verified"
        Solution:
        â†’ Delete the app if it's partially installed
        â†’ Restart iPhone
        â†’ Try installing again
        â†’ Make sure you downloaded the SIGNED IPA from GitHub Actions

        âŒ App installs but crashes immediately on launch
        Solution:
        â†’ Make sure you trusted the certificate (see steps above)
        â†’ Check iOS version (needs iOS 15.8.5)
        â†’ Try deleting app and reinstalling
        â†’ Check GitHub Actions logs for build errors

        âŒ Diawi link shows "Not Found" or expired
        Solution:
        â†’ Diawi links expire after 24 hours
        â†’ Upload the IPA to Diawi again to get new link
        â†’ Install immediately after getting link

        âŒ Can't find "VPN & Device Management" in Settings
        Solution:
        â†’ This section only appears AFTER you install the app
        â†’ Install the app first, then look for this setting
        â†’ On some iOS versions it's called "Profiles & Device Management"

        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        ðŸ’° COST BREAKDOWN:

        Your Current Setup:
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Apple ID:          FREE ($0)       â”‚
        â”‚ Code Signing:      FREE ($0)       â”‚
        â”‚ GitHub Actions:    FREE ($0)       â”‚
        â”‚ Diawi hosting:     FREE ($0)       â”‚
        â”‚ Installation:      FREE ($0)       â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚ TOTAL:             $0 / year! ðŸŽ‰   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

        Alternative (Paid):
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Apple Developer Program: $99/year  â”‚
        â”‚ Benefits:                          â”‚
        â”‚   â€¢ 1-year certificates            â”‚
        â”‚   â€¢ TestFlight beta testing        â”‚
        â”‚   â€¢ App Store publishing           â”‚
        â”‚   â€¢ Advanced capabilities          â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

        For testing and personal use, FREE signing is perfect! âœ…

        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        ðŸ“š ADDITIONAL RESOURCES:

        Diawi Help: https://www.diawi.com/
        AltStore: https://altstore.io/
        Sideloadly: https://sideloadly.io/
        
        Apple Developer: https://developer.apple.com/
        GitHub Actions Logs: Check your repository's Actions tab

        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        ðŸŽ‰ ENJOY YOUR APP ON iPHONE 7!

        Your ICCCAlert app is now running on real hardware!
        Test everything, find bugs, and iterate quickly.

        Remember: Rebuild every 6 days to keep it working!

        Questions or issues? Check the GitHub Actions logs for details.

        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        EOF
        
        echo ""
        echo "ðŸ“„ Installation guide created!"
        echo ""
        cat ./build/INSTALLATION_INSTRUCTIONS.txt
    
    - name: Upload Installation Guide
      uses: actions/upload-artifact@v4
      with:
        name: Installation-Instructions
        path: build/INSTALLATION_INSTRUCTIONS.txt
        retention-days: 30
    
    - name: Success Summary
      run: |
        echo ""
        echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
        echo "â•‘          ðŸŽ‰ SUCCESS! IPA IS SIGNED & READY! ðŸŽ‰         â•‘"
        echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
        echo ""
        echo "ðŸ“¦ DOWNLOAD THESE ARTIFACTS:"
        echo "   1. ICCCAlert-Signed-IPA â† Your signed app!"
        echo "   2. Installation-Instructions â† How to install"
        echo ""
        echo "â° Certificate valid for: 7 days"
        echo "ðŸ’° Total cost: FREE ($0)!"
        echo "ðŸ“± Ready for iPhone 7 (iOS 15.8.5)"
        echo ""
        echo "ðŸš€ NEXT STEPS (No Mac Needed!):"
        echo ""
        echo "   1. Scroll down to 'Artifacts' section below"
        echo "   2. Download 'ICCCAlert-Signed-IPA' (click to download)"
        echo "   3. Extract ZIP file to get the .ipa file"
        echo "   4. Go to https://www.diawi.com/ on any device"
        echo "   5. Upload the .ipa file to Diawi"
        echo "   6. Get the Diawi link (i.diawi.com/XXXXX)"
        echo "   7. Open that link in Safari on your iPhone 7"
        echo "   8. Tap 'Install' and wait"
        echo "   9. Go to Settings â†’ General â†’ Device Management"
        echo "  10. Trust your Apple ID certificate"
        echo "  11. Launch ICCCAlert from home screen"
        echo "  12. Test your WebSocket connections! âœ…"
        echo ""
        echo "ðŸ“– Full instructions in 'Installation-Instructions' artifact"
        echo ""
        echo "ðŸ’¡ Remember: Rebuild in 6 days to renew certificate!"
        echo ""
        echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
        echo ""